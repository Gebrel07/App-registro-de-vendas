{% extends 'vendas/partials/base.html' %}

{% comment %}
TODO: Definir a lógica da aba cálculo
{% endcomment %}

{% block content %}

{% load static %}
<script src="{% static 'vendas/venda.js' %}"></script>
<script src="{% static 'vendas/calculos.js' %}"></script>

<div class="container mt-4">
    <div id="loadingSpinner" class="spinner-border text-primary" role="status" style="width:50px;height:50px;display: none; position: fixed; top: 50%; left: 50%; z-index: 1000;">
        <span class="visually-hidden">Carregando...</span>
    </div>

    <!-- Modal personalizado para deletar produtos de maneira variavel -->
    {% include 'vendas/venda/modal_remover_produto.html' %}
    
    <!-- Abas -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="aba-inicial-tab" data-bs-toggle="tab" data-bs-target="#aba-inicial" type="button" role="tab" aria-controls="aba-inicial" aria-selected="true">Vender</button>
        </li>
        <li class="nav-item" role="presentation">
            <button onclick="calcular()" class="nav-link" id="aba-calculos-tab" data-bs-toggle="tab" data-bs-target="#aba-calculos" type="button" role="tab" aria-controls="aba-calculos" aria-selected="false">Cálculos</button>
        </li>
    </ul>
    
    <!-- Conteúdo das Abas -->
    <div class="tab-content shadow p-3 mb-5 bg-body rounded" id="myTabContent">

        <!-- Aba Inicial -->
        {% include 'vendas/venda/aba_venda.html' %}


<!-- Aba de Cálculos -->
<div class="tab-pane fade" id="aba-calculos" role="tabpanel" aria-labelledby="aba-calculos-tab">
    <!-- Conteúdo da aba de cálculos -->        
     {% include 'vendas/partials/modal.html' with form_action_url='' title='Limpar venda' body='Deseja mesmo limpar a venda?' btn_text="Limpar" btn_class="danger"%}
    <div id="MSGmodificaçãoDesconto"class="alert alert-success" style="display:none;">
        O desconto foi alterado com sucesso
    </div>
    <div class="container my-4 p-3 border border-info rounded">
        <div class="row mb-3">
            <div class="col-sm-6 ">
                <label for="parcelasSelect" class="col-sm-4 col-form-label">Parcelas</label>
                <select class="form-select" id="parcelasSelect">
                    <option value="1">A vista</option>
                    <option value="2">1x</option>
                    <option value="3">2x</option>
                    <option value="4">3x</option>
                    <option value="5">4x</option>
                    <option value="6">5x</option>
                    <option value="7">6x</option>
                </select>
            </div>
 
            <div class="col-sm-6">
                <label for="comissaoInput" class="col-sm-2 col-form-label">Comissão</label>
                <input type="text" class="form-control" id="comissaoInput" readonly>
            </div>
        </div>
        <div class="container my-2 p-2 border rounded" style="font-size: smaller; width: 50%;">
            <div class="row mb-3 text-center">
                <label for="totalVendaInput" class="col-sm-12 col-form-label">Total da Venda</label>
                <div class="col-sm-12">
                    <input type="text" class="form-control" id="totalVendaInput" readonly>
                </div>
            </div>
            <div class="row mb-3 text-center">
                <div> 
                    <label class="col-sm-12 col-form-label">Desconto total%</label>
                </div>
                <div class="col-sm-12">
                    <div class="input-group">
                        <input type="text" class="form-control" id="descontoInput">
                        <span class="material-symbols-outlined text-warning"
                        id = 'triggerElement' 
                        data-bs-toggle="tooltip" 
                        data-bs-placement="top" 
                        title="Você pode alterar o desconto total!!"
                        style="font-size:40px;"
                        >
                            priority_high
                    </span>
                    </div>
            </div>
        </div>
    </div>
    <div class="text-center my-4">
        <button onclick='enviarVenda()'class="btn btn-primary btn-lg mx-2">Finalizar Venda</button>
        <button 
            class="btn btn-danger btn-lg mx-2"
            type="button"
            data-bs-toggle="modal"
            data-bs-target = "#modal"
            onclick = "limparVenda()"
            >Limpar Venda</button>
    </div>
</div>



{% endblock %}
